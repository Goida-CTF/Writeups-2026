
# Тук-Тук
Сложность: `Сложно`

Описание:

```
Решили у нас в россии импортазаместить тикток, 
из уникальных решений было то, что если ты публикуешь что то не то, 
то "Тук-Тук" из названия приложения превращается в звук около вашей двери
но разработку зачем то заказали у финских подрядчиков, 
по этому как только наш работяга Петрович начал им пользоваться - 
все государственные секреты куда то улетели

Можете найти как и куда и побробовать добыть какие то данные с их сервера?


по вопросам к автору - https://t.me/ACORU
```


## Теги
`#reverse` `#android`

## Выдать участникам
[goida-tok.zip](https://disk.yandex.ru/d/TxI9oh63jvg0kw)

## Решение
Получаем apk файл какого то приложения и нечто со словом backup в названии
пытаемся распаковать бекап и получаем обычную зипку
шаримся по ней и видим много чего интересного: Записи Петровича и SQLite db в которых ничего интересного.
 Однако там есть файлик auth.xml и можно вспомнить что в xml в андроиде хранятся sharedPreferences.
Смотрим в тело APK и помимо всего находим кучу обращений к gRPC. находим интересные классы с именями Exfiltrate и так далее. И класс Fbi. в нем забираем protobuf схему и пытаемся постучать на сервер, адрес которого (goida.gulenok.ru)  можно найти в GrpcFBIController. Но получаем unauthorized. 
Вспоминаем, что у нас так то есть какой то токен авторизации (метод setAuthToken в GrpcFBIController как бы намекает)
Прокидываем его в Bearer в gRPC  и получаем флаг
## Флаг
    goidactf{t0k_t0k_st3ler_g0es_brr}

