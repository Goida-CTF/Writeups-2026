Тук-Тук
==

Автор: https://t.me/ACORU

GIVE: https://disk.yandex.ru/d/j_4MtHnPXWocyA

Сурсы тасков: Если прямо очень надо то в ЛС автору
 ```
note: за основу таска был взят PET проект который писался 4 месяца. 
Его суть в том, что бы записывать видео длительностью в 1 секунду
и сортировать их по папкам, которые синхронизируются между вами и вашими друзьями для сохранения
интересных моментов жизни

при этом по кнопке (которая в данном вам билде была реализована только на бекенде)
все видео можно собрать в одну большую историю под музыку для соцсетей/etc

когда-нибудь это чудо дойдет до релиза..

если вам интересно почитать сырые исходники этого чуда или стать бетатестером 
когда разработка закончиться - милости прошу в личные сообщения
 ```

 V1
 ==
Описание:

```
Решили у нас в россии импортазаместить тикток, 
из уникальных решений было то, что если ты публикуешь что то не то, 
то "Тук-Тук" из названия приложения превращается в звук около вашей двери
но разработку зачем то заказали у финских подрядчиков, 
по этому как только наш работяга Петрович начал им пользоваться - 
все государственные секреты куда то улетели

Можете найти как и куда и побробовать добыть какие то данные с их сервера?


по вопросам к автору - https://t.me/ACORU
```


Получаем APK. Открываем JADxом. Смотрим в жадх пока жадх не начнет смотреть на вас

пытаемся распаковать бекап и получаем обычную зипку

шаримся по ней и видим много чего интересного: Записи Петровича и SQLite db в которых ничего интересного.

 Однако там есть файлик auth.xml и можно вспомнить что в xml в андроиде хранятся sharedPreferences.

Смотрим в тело APK и помимо всего находим кучу обращений к gRPC. находим интересные классы с именами 

Exfiltrate и так далее. И класс Fbi. в нем забираем protobuf схему и пытаемся постучать на сервер, адрес которого (goida.gulenok.ru)  можно найти в GrpcFBIController. 

Но получаем unauthorized. 

Вспоминаем, что у нас так то есть какой то токен авторизации (метод setAuthToken в GrpcFBIController как бы намекает)

Прокидываем его в Bearer в gRPC  и получаем флаг

PWNED!



из интересных решений что я видел - ручку можно было достать в динамике network-inspectorом

V2
==
К вечеру первого дня я понял, что как то скучно и сделал типо ревенжа, из которого выпилил FBI контроллер, откатившись на последний релиз, но добавил прикол на бекенде


открываем приложение

смотрим

понимаем что оно нужно для обмена короткими видео

и что в отличие от старой версии у нас в GrpcBackendController 

и видим что при открытии одной из активити оно вызывает GetVideosController

смотрим что он вернул 

видим что то типо. 

```
        {
            "author": "02ffc1b5-f5c3-4bb6-a28e-b08f435ed62a",
            "id": "a3cc73b3-a9b3-4d72-a7c8-1004ae3cc6f7",
            "thumbnail": "https://storage.yandexcloud.net/hetket/a3cc73b3-a9b3-4d72-a7c8-1004ae3cc6f7",
            "date": "1769876883"
        },
```
(бакет после соревнований я снова сделаю приватным лол)
понимаем, что приложение хранит данные на s3
смотрим в описание
видим слово ведро

делаем curl по https://storage.yandexcloud.net/hetket (листинг бакета был включен)

находим там интересный файл bubba_trump.mov

PWNED


Постмортем
===
Для первого ТБ таска сделаного мною опыт я считаю удачным
были проблемы с авторизацией, но ее можно было зафейковать через манипуляцию auth.xml

решение сделать вторую часть мне навеяло то, что по логам я обнаружил как люди пытались брутить папки FBI, root, goida итд

больше всего меня удивили люди которые уже на новом бекенде пытались брутить invite коды
**ЧЕРЕЗ CLOUDFLARE**

я очень рад что многим понравился таск, спасибо всем 67 людям которые зарегались в Hetket и пробовали решать таск

спасибо тем, кто пошел пентестить инфру на *.gulenok.ru. за это кстати полагается небольшой баунти

шутка про финских подрядчиков идет из названия приложения (hetket это моменты на финском), 

но забавно было наблюдать как джбт наголлюцинировал кому то флаг 



## Флаг
    goidactf{t0k_t0k_st3ler_g0es_brr}
    goidactf{hubba_b00ba}

