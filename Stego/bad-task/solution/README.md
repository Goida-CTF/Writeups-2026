# Гнилой таск - Write up

## TL;DR
Символы флага были скрыты где-то на кадрах - нужно было применить зоркий глаз, а также можно было бы чуть облегчить себе жизнь и некоторые символы уже найти алгоритмически.

Если хотите увидеть где символы были скрыты в потоке, то можете погрепать [`./solve.txt`](./solve.txt) по ключевому слову "HERE".

## Writeup

Для решения данного таска нужно в принципе знать про шедоу арт-версию видео `Bad Apple!!`: https://youtu.be/FtutLA63Cp8

Подключаемся по `nc` к инстансу, видим как кадры отрисовываются из двух символов ■□, каждый кадр по 8 строк в длину, 18 символов в ширину, с частотой 25 кадров в секунду. Перенаправляем вывод в файл, скачиваем себе таким образом локальную версию.

Если просмотреть несколько раз анимацию, на первых секундах видно, как что-то вдруг промелькивает, а потом исчезает (особенно, когда фон белый, и мелькает что-то чёрное). При поиске на локальной копии можно заметить, как будто символы стоят там, где их быть не должно - присмотревшись, можно осознать символ. Из этого понимаем, что символы флага в виде символов располагаются где-то на кадрах.

Здесь всё упирается в то, что обойтись полностью алгоритмизированным способом не получится - в любом случае потребуется в начале найти пару символов и попытаться понять правила, по которым они составляются.

Дополнительно был добавлен хинт на то, что никакие шифры не применяются - мне довольно много писали бедолаги, собирающие неверный флаг и пытавшиеся его прогнать через dcode по разным алгоритмам. Чтобы люди так не делали, и не тратили на это время, был добавлен хинт, даже с учетом на тот момент ФБ от одной из команд (за что им респект, первые кто решили без хинта!).

Метод "полностью глазками" мы не рассматриваем, он итак очевный - поэтому рассмотрим способ через какую никакую попытку алгоритмизации, которая должна чуть упростить жизнь.

Попытка алгоритмизации заключается в том, чтобы попытаться угадать алфавит. Используемый алфавит выглядит так (для удобства белыми символами отображаю контур, а черными незаполненное пространство):
```
G
□■■■
■□□□
■□□■
□■■□

O
□■■□
■□□■
■□□■
□■■□

I
■■■
□■□
□■□
■■■

D
■■■□
■□□■
■□□■
■■■□

A
□■■□
■□□■
■■■■
■□□■

C
□■■■
■□□□
■□□□
□■■■

T (используемый символ по контуру чуть отличается)
■■■■
□■■□
□■■□
□■■□

F
■■■■□
■□□□□
■■■■□
■□□□□

{
□□□■■
□□■□□
■■■□□
□□■□□
□□□■■

R (используемый символ по контуру чуть отличается)
■■■□
■□□■
■■■□
■□□■

_
■■■■■
□□□□□
■■■■■

B
■■□
■□■
■■□
■□■
■■□

4
■□□■
■■■■
□□■■
□□■■

5
■■■■
■□□□
■■■■
□□□■
■■■■

K
■□□■
■■■□
■□□■
■□□■

}
■■□□□
□□■□□
□□■■■
□□■□□
■■□□□
```

Увидев какие-то из символов, можно было написать алгоритм, чтобы попробовать их найти в не зависимости от фона, либо опять же попробовать перебрать алфавит. Символы подчиняются правилу: они пытаются записываться в 4x4 пикселях - если не влезают, то в пределе 5x5.

На самом деле тем, кто хорошо помнит что происходит поминутно в шедоу арте, было легче - вы бы сразу могли увидеть, что где-то находится что-то, чего в видео быть не должно, но это способ мега-фанатов, помнящих абсолютно все действия наизусть (я такой).

Флаг специально был выбран таким образом, чтобы переиспользовать символы, таким образом полу-алгоритмизация была возможной. Но кто-то где-то мог видеть также символы, которых на самом деле нет. В чате CTF можно было видеть, как упоминалось, что флаг не является рандомным набором символов и является осознанным.

Сам смысл флага - сокращение от "for real bad task, i know". Как никак таск гнилой, о чем и говорит его название :)
Надеюсь, что вы прислушались совета из алерта на платформе и слушали при решении фоном Bad Apple!!, для того, чтобы проникнуться атмосферой смысла песни, и вы внезначай увидев что-то подобное на другой CTF или где-то еще, с грустью на душе, вспоминая таск, начали бы задумываться о словах песни, припевая:

> Nagarete ku toki no naka de demo...

### Интересная попытка решения

Я знаю об умной попытке решения полной алгоритмизации, которую одна из команд пыталась применить, что заслуживает им моего респекта! (сам бы на таком таске попытался решить как они)

Попытка заключается в следующем - самому попытаться проконвертировать файл с видео шедоу арта Bad Apple!! тем же способом, которым предположительно файл в таске был сделан: попытаться превратить его в пиксели и задиффать различия. Такой способ являлся бы полной алгоритмизацией, а также смог бы определить в принципе даже без хинта то как флаг скрыт.

Однако к сожалению, я предусмотрел, что такой способ скорее всего тут не сработает - во-первых, частота обновления оригинального видео - 30 FPS, а в этом таске он 25 FPS. К тому же при определении цвета пикселя нужно знать правильный threshold-процент черного - ибо края силуэтов в видео являются серым цветом, и нужно определять станет ли пиксель черным, или белым (ибо на выходе у нас нет никаких оттенков серого).

Как же я предусмотрел, что такой скорее всего тут не сработает? Я составлял этот файл более 5-ти лет назад, и не помню по какому алгоритму я это делал ;)

Так что попытка была достойная!

Ну а это завершение гнилого врайтапа, всем пис!
